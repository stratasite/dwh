<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><p><a href="https://github.com/stratasite/dwh/actions"><img src="https://github.com/stratasite/dwh/workflows/Ruby/badge.svg" alt="Ruby"></a></p>

<h1 id="dwh-data-warehouse-adapter-library">DWH - Data Warehouse Adapter Library</h1>

<p>A light weight library to connect, introspect, and query popular databases over a unified interface.  This gem is intended for analtyical workloads.  The library also provides database specific translations for common functions like <code>date_trunc</code>, <code>date_add</code> etc.  The function tranlation is not comprehensive. But, it does provides good coverage for date handling, and some array handling as well.</p>

<blockquote>
<p>[!NOTE]
<strong>This is not an ORM</strong> nor will it cast types to ruby unless the underlying client does it out of the box.  The goal here is to create an Architecture where new databases can be onboarded quickly.</p>
</blockquote>

<h2 id="why-do-we-need-another-database-abstraction-layer">Why do we need another database abstraction layer?</h2>

<p>Libraries like <a href="https://github.com/jeremyevans/sequel">Sequel</a> are amazing and comprehensive.  However, its broad coverage also makes it more laborious to add new databases.  Especially, ones with only HTTP endpoints for Ruby.  We seem to be having an explosion of databases recently and a light weight interface will allow us to integrate faster.</p>

<p>The adapter only has 5 core methods (6 including the connection method).  A YAML settings controls how it interacts with a particular db.  It is relatively fast to add a new db. See the <a href="http://github.com/stratasite/dwh/blob/main/lib/dwh/adapters/druid.rb">Druid</a> implementation as an example. And <a href="https://github.com/stratasite/dwh/blob/main/lib/dwh/settings/druid.yml">here</a> is its corresponding YAML settings file.</p>

<h2 id="features">Features</h2>

<ul>
<li><strong>Unified Interface</strong>: Connect to multiple database types using the same API</li>
<li><strong>SQL Function Translation</strong>: Automatically translates common SQL functions to database-specific syntax</li>
<li><strong>Connection Pooling</strong>: Built-in connection pool management for high-performance applications</li>
<li><strong>Rich Metadata</strong>: Extract table schemas, column information, and statistics</li>
</ul>

<h2 id="supported-databases">Supported Databases</h2>

<ul>
<li><strong>Snowflake</strong> - High performance cloud warehouse</li>
<li><strong>Trino</strong> (formerly Presto) - Distributed SQL query engine</li>
<li><strong>AWS Athena</strong> - AWS big data warehouse</li>
<li><strong>Apache Druid</strong> - Real-time analytics database</li>
<li><strong>DuckDB</strong> - In-process analytical database</li>
<li><strong>PostgreSQL</strong> - Full-featured RDBMS with advanced SQL support</li>
<li><strong>MySQL</strong> - Popular open-source database</li>
<li><strong>SQL Server</strong> - Microsoft&#39;s enterprise database</li>
</ul>

<h2 id="integrations-coming-soon">Integrations Coming Soon</h2>

<ul>
<li><strong>Redshift</strong> - AWS data warehouse platform</li>
<li><strong>ClickHouse</strong> - High performance analytical db</li>
<li><strong>Databricks</strong> - Big data compute engine</li>
<li><strong>MotherDuck</strong> - Hosted DuckDB service</li>
</ul>

<h2 id="quick-start">Quick Start</h2>

<p>Install it yourself as:</p>

<pre class="code bash"><code class="bash">gem install dwh
</code></pre>

<h3 id="connect-and-execute-a-basic-query">Connect and Execute a Basic Query</h3>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dwh</span><span class='tstring_end'>&#39;</span></span>

<span class='comment'># Connect to Druid
</span><span class='id identifier rubyid_druid'>druid</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DWH.html" title="DWH (module)">DWH</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DWH/Factory.html#create-instance_method" title="DWH::Factory#create (method)">create</a></span></span><span class='lparen'>(</span><span class='symbol'>:druid</span><span class='comma'>,</span> <span class='lbrace'>{</span>
  <span class='label'>host:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='label'>port:</span> <span class='int'>8080</span><span class='comma'>,</span>
  <span class='label'>protocol:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http</span><span class='tstring_end'>&#39;</span></span>
<span class='rbrace'>}</span><span class='rparen'>)</span>

<span class='comment'># basic query execution
</span><span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='id identifier rubyid_druid'>druid</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM web_sales</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>format:</span> <span class='symbol'>:csv</span><span class='rparen'>)</span>
</code></pre>

<h2 id="core-api">Core API</h2>

<p>Standardized API across adapters:</p>

<dl>
  <dt>connection</dt>
  <dd>Creates a reusuable connection based on config hash passed in</dd>
  <dt>tables(schema: nil, catalog: nil)</dt>
  <dd> returns a list of tables from the default connection or from the specified schema and catalog </dd>
  <dt> metadata(table_name, schema: nil, catalog: nil) </dt>
  <dd> provides metadata about a table </dd>
  <dt>stats(table_name, date_column: nil) </dt>
  <dd> provides table row count and date range </dd>
  <dt> execute(sql, format: :array, retries: 0) </dt>
  <dd> runs a query and returns in given format </dd>
  <dt> execute_stream(sql, io, stats: nil) </dt>
  <dd> runs a query and streams it as csv into the given io </dd>
</dl>

<h2 id="tutorials-and-guides">Tutorials and Guides</h2>

<ul>
<li><a href="https://strata.site/dwh/file.getting-started.html">Getting Started</a></li>
<li><a href="https://strata.site/dwh/file.adapters.html">Adapter Configuration</a></li>
<li><a href="https://strata.site/dwh/file.creating-adapters.html">Creating an Adapter</a></li>
<li><a href="https://strata.site/dwh/file.usage.html">Advanced Usage</a></li>
<li><a href="https://strata.site/dwh/DWH.html">API</a></li>
</ul>

<h2 id="testing">Testing</h2>

<p>Certain databases have to be tested via docker. Those tests will try to launch docker compose services in <code>test/support/compose*.yml</code></p>

<p>Run Unit Tests:</p>

<pre class="code bash"><code class="bash">bundle exec rake test:unit
</code></pre>

<p>Run tests on RDBMS dbs:</p>

<pre class="code bash"><code class="bash">bundle exec rake test:system:rdbms 
</code></pre>

<p>Run tests on  druid:</p>

<pre class="code bash"><code class="bash">bundle exec rake test:system:druid 
</code></pre>

<h2 id="development">Development</h2>

<p>After checking out the repo, run <code>bin/setup</code> to install dependencies. Then, run <code>rake test</code> to run the tests. You can also run <code>bin/console</code> for an interactive prompt.</p>

<p>To install this gem onto your local machine, run <code>bundle exec rake install</code>.</p>

<h2 id="contributing">Contributing</h2>

<p>Bug reports and pull requests are welcome on GitHub at <a href="https://github.com/stratasite/dwh">https://github.com/stratasite/dwh</a>.</p>

<h2 id="license">License</h2>

<p>This project is available as open source under the terms of the MIT License.</p>

<h2 id="version">Version</h2>

<p>Current version: 0.1.0</p>
</div></div>

      <div id="footer">
  Generated on Fri Sep 19 14:34:07 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.4).
</div>

    </div>
  </body>
</html>