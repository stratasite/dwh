# Date Literal Formats
day_name_format: "Day"
abbreviated_day_name_format: "Dy"
month_name_format: "Month" 
abbreviated_month_name_format: "Mon"

# Date functions patterns
current_date: "CURRENT_DATE"
current_time: "CURRENT_TIME"
current_timestamp: "CURRENT_TIMESTAMP"
truncate_date: "DATE_TRUNC('@unit', @exp)"
date_add: "DATEADD(@unit, @val, @exp)"
date_diff: "DATEDIFF(@unit, @start_exp, @end_exp)"
date_format_sql: "TO_CHAR(@exp, '@format')"
date_literal: "'@val'::DATE"
date_time_literal: "'@val'::TIMESTAMP"
extract_year: 'EXTRACT(YEAR FROM @exp)'
extract_month: 'EXTRACT(MONTH FROM @exp)'
extract_quarter: 'EXTRACT(QUARTER FROM @exp)'
extract_day_of_year: 'EXTRACT(DOY FROM @exp)'
extract_day_of_month: 'EXTRACT(DAY FROM @exp)'
extract_day_of_week: 'EXTRACT(DOW FROM @exp)'
extract_week_of_year: 'EXTRACT(WEEK FROM @exp)'
extract_hour: 'EXTRACT(HOUR FROM @exp)'
extract_minute: 'EXTRACT(MINUTE FROM @exp)'
extract_year_month: "TO_CHAR(@exp, 'YYYYMM')::INTEGER"
default_week_start_day: "monday" # Redshift uses Sunday as default
week_start_day: "monday"
sunday_week_start_day: "DATEADD(day, -1, DATE_TRUNC('WEEK', DATEADD(DAY,  1, @exp)))"
monday_week_start_day: "DATEADD(day,  1, DATE_TRUNC('WEEK', DATEADD(day, -1, @exp)))"

# string functions
trim: "TRIM(@exp)"
lower_case: "LOWER(@exp)"
upper_case: "UPPER(@exp)"

# null handling
if_null: "COALESCE(@exp, @when_null)"
null_if: "NULLIF(@exp, @target)"
null_if_zero: "NULLIF(@exp, 0)"

# array operations
supports_array_functions: false
