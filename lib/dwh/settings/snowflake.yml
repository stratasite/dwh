
# Date Literal Formats
date_format: "%Y-%m-%d"
date_time_format: "%Y-%m-%d %H:%M:%S"
date_time_tz_format: "%Y-%m-%d %H:%M:%S %Z"
date_type: "string" # alternative is int, integer, dateint
day_name_format: "DY"
abbreviated_day_name_format: "DY"
month_name_format: "MMMM"
abbreviated_month_name_format: "MON"

# Date functions patterns
current_date: "CURRENT_DATE()"
current_time: "CURRENT_TIME()"
current_timestamp: "CURRENT_TIMESTAMP()"

date_add: "DATEADD(@unit, @val, @exp)"
date_diff: "DATEDIFF(@unit, @start_exp, @end_exp)"
date_format_sql: "TO_VARCHAR(@exp, '@format')"
date_literal: "'@val'::DATE"
date_time_literal: "'@val'::TIMESTAMP"
extract_year: 'YEAR(@exp)'
extract_month: 'MONTH(@exp)'
extract_quarter: 'QUARTER(@exp)'
extract_day_of_year: 'DAYOFYEAR(@exp)'
extract_day_of_month: 'DAY(@exp)'
extract_day_of_week: 'DAYOFWEEK(@exp)'
extract_week_of_year: 'WEEK(@exp)'
extract_hour: 'HOUR(@exp)'
extract_minute: 'MINUTE(@exp)'
extract_year_month: 'CAST((TO_VARCHAR(@exp, ''YYYY'') || TO_VARCHAR(@exp, ''MM'')) as integer)'
default_week_start_day: "monday"
week_start_day: "monday"
sunday_week_start_day: "DATEADD(day, -1,DATE_TRUNC('week', DATEADD(day,1, @exp)))"
monday_week_start_day: "DATEADD(day, 1,DATE_TRUNC('week', DATEADD(day,-1, @exp)))"

# array operations
array_in_list: "ARRAY_CONTAINS(@exp, ARRAY_CONSTRUCT(@list))"
array_exclude_list: "NOT ARRAY_CONTAINS(@exp, ARRAY_CONSTRUCT(@list))"
apply_advanced_filtering_on_array_projections: false # druid needs a having clause or un-nesting
array_unnest_join: "LATERAL FLATTEN(INPUT => @exp) @alias"

# null handling
if_null: "NVL(@exp, @when_null)"
null_if_zero: "NULLIFZERO(@exp)"
